{
  "schemaVersion": "2026.01.tasks-v1",
  "effectId": "01KHWQBAEGWYYH6PDSDT37PH75",
  "taskId": "implement-phase",
  "invocationKey": "central-tauri-build:S000031:implement-phase",
  "stepId": "S000031",
  "kind": "agent",
  "title": "Implement: Terminal (6/8)",
  "labels": [
    "agent",
    "implementation",
    "phase-6-terminal"
  ],
  "io": {
    "inputJsonPath": "tasks/01KHWQBAEGWYYH6PDSDT37PH75/input.json",
    "outputJsonPath": "tasks/01KHWQBAEGWYYH6PDSDT37PH75/result.json"
  },
  "inputs": {
    "claudeMdPath": "/Users/agam/dev/CentralTauri/CLAUDE.md",
    "phase": {
      "description": "xterm.js v5 setup with @xterm/xterm and addons: @xterm/addon-fit, @xterm/addon-web-links, @xterm/addon-webgl. portable-pty in Rust backend for real PTY. PTY spawn/resize/write via Tauri Channels API (NOT events). ResizeObserver → debounced fit → resize PTY. Terminal placed in right pane below file viewer in resizable split. One terminal per project (not per agent). IMPORTANT: call term.dispose() on unmount, don't call fit() before container is visible.",
      "id": "phase-6-terminal",
      "name": "Terminal",
      "screenshotDescription": "Right pane split: file viewer on top, terminal on bottom showing a shell prompt. Terminal has dark theme matching app.",
      "tasks": [
        "xterm.js setup with fit, web-links, webgl addons",
        "portable-pty in Rust backend",
        "PTY spawn/resize/write via Tauri Channels",
        "ResizeObserver → debounced fit → PTY resize",
        "Terminal in right pane below file viewer, resizable split"
      ],
      "verifyCommand": "cd /Users/agam/dev/CentralTauri && cargo test --manifest-path src-tauri/Cargo.toml && pnpm tsc --noEmit"
    },
    "phaseIndex": 6,
    "planPath": "/Users/agam/dev/CentralTauri/PLAN.md",
    "previousPhases": [
      {
        "id": "phase-1-setup",
        "name": "Project Setup",
        "summary": "Scaffolded complete Tauri v2 + React 19 + TypeScript strict project. Configured Vite, ESLint flat config, Prettier, Tailwind v3 + shadcn/ui with dark theme HSL vars from PLAN.md, Zustand, neverthrow, lucide-react. Rust backend with git2-rs (vendored), tauri-plugin-sql (SQLite), dialog, notification, shell plugins. SQLite schema with all 4 tables (projects, agent_sessions, messages, app_settings) + indexes. Feature-based directory structure. All checks pass: tsc --noEmit, cargo build, cargo clippy, vitest (3/3), vite build."
      },
      {
        "id": "phase-2-layout",
        "name": "Core Layout + Projects",
        "summary": "Implemented Phase 2: Core Layout + Projects. Three-pane resizable layout (left 20%, middle 50%, right 30%), project sidebar with full CRUD, folder picker via Tauri dialog, SQLite persistence via @tauri-apps/plugin-sql JS API, Zustand store with selectors, dark theme styling. 8 shadcn/ui components installed. All TypeScript and Rust compiles clean."
      },
      {
        "id": "phase-3-agents",
        "name": "Agent Orchestration",
        "summary": "Implemented Phase 3: Agent Orchestration. Mock Node.js sidecar with JSON-lines protocol, Rust sidecar manager with Tauri events, agent CRUD commands, SQLite persistence, Zustand agent store, and full Chat UI (MessageBubble, ThinkingBlock, ToolCallBlock, PromptInput, MessageQueue). Event bridge connects backend to frontend."
      },
      {
        "id": "phase-4-monitoring",
        "name": "Agent Monitoring + Switching",
        "summary": "Implemented Phase 4: Agent Monitoring + Switching. Added agent sessions nested under projects in sidebar with status badges (spinner/green/red/gray/amber dots). Click session switches active agent. Scroll positions preserved per-session. macOS notifications on completion/failure. Selective Zustand subscriptions for performance. Extracted sessionActions.ts and ChatEmptyState.tsx from ChatPane."
      },
      {
        "id": "phase-5-files",
        "name": "File Viewer + Git",
        "summary": "Implemented Phase 5: File Viewer + Git. Rust git2-rs commands split into 6 sub-modules (tree, status, diff, types, git_helpers). CodeMirror 6 read-only viewer with custom dark theme, Compartment-based dynamic language switching, lazy language imports. File tree with git status indicators. Diff viewer with line coloring. Git status bar. FilesPanel with resizable split."
      }
    ],
    "projectPath": "/Users/agam/dev/CentralTauri",
    "totalPhases": 8
  }
}
